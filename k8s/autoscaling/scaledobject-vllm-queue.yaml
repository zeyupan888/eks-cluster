apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: vllm-queue
  namespace: llm
spec:
  scaleTargetRef:
    kind: Deployment
    name: vllm
  pollingInterval: 15
  cooldownPeriod: 300
  minReplicaCount: 1
  maxReplicaCount: 6
  triggers:
    - type: prometheus
      metadata:
        serverAddress: http://kube-prometheus-stack-prometheus.monitoring.svc.cluster.local:9090
        metricName: vllm_request_queue_depth
        query: max(vllm_request_queue_depth{namespace="llm"})
        threshold: "5"
